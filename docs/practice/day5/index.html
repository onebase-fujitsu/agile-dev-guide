<!doctype html><html lang=ja dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  5日目
  #

ではTodoを作成するバックエンドAPIを作成していきましょう。

  タスク作成バックエンドAPI
  #


  テスト
  #

まず、サーバのテストを書いてみましょう。
POST /todosに対してJSONをボディにセットして、リクエストしたときの、 レスポンスコードとレスポンスデータを確認するテストを書いてみます。"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://onebase-fujitsu.github.io/agile-dev-guide/docs/practice/day5/"><meta property="og:site_name" content="Fujitsu Agile Development Guide"><meta property="og:title" content="5日目"><meta property="og:description" content="5日目 # ではTodoを作成するバックエンドAPIを作成していきましょう。
タスク作成バックエンドAPI # テスト # まず、サーバのテストを書いてみましょう。 POST /todosに対してJSONをボディにセットして、リクエストしたときの、 レスポンスコードとレスポンスデータを確認するテストを書いてみます。"><meta property="og:locale" content="ja"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>5日目 | Fujitsu Agile Development Guide</title>
<link rel=icon href=/agile-dev-guide/favicon.png><link rel=manifest href=/agile-dev-guide/manifest.json><link rel=canonical href=https://onebase-fujitsu.github.io/agile-dev-guide/docs/practice/day5/><link rel=stylesheet href=/agile-dev-guide/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/agile-dev-guide/><span>Fujitsu Agile Development Guide</span></a></h2><ul><li><a href=/agile-dev-guide/docs/introduction/>はじめに</a></li><li><input type=checkbox id=section-fe72557a7878dded4efa0060e21abacc class=toggle>
<label for=section-fe72557a7878dded4efa0060e21abacc class="flex justify-between"><a role=button>アジャイル</a></label><ul><li><a href=/agile-dev-guide/docs/agile/manifest/>アジャイルソフトウェア開発宣言</a></li><li><a href=/agile-dev-guide/docs/agile/principle/>アジャイル開発12の原則</a></li><li><a href=/agile-dev-guide/docs/agile/conclude/>まとめ</a></li></ul></li><li><input type=checkbox id=section-60906829343241fe59efbb09409d99f8 class=toggle>
<label for=section-60906829343241fe59efbb09409d99f8 class="flex justify-between"><a role=button>スクラム</a></label><ul><li><a href=/agile-dev-guide/docs/scrum/overview/>スクラムとは</a></li><li><a href=/agile-dev-guide/docs/scrum/roles/>ロール</a></li><li><a href=/agile-dev-guide/docs/scrum/products/>成果物</a></li><li><a href=/agile-dev-guide/docs/scrum/events/>イベント</a></li><li><a href=/agile-dev-guide/docs/scrum/conclude/>まとめ</a></li></ul></li><li><input type=checkbox id=section-8258873460fa80799dab8ced5b37f178 class=toggle>
<label for=section-8258873460fa80799dab8ced5b37f178 class="flex justify-between"><a role=button>エクストリームプログラミング</a></label><ul><li><a href=/agile-dev-guide/docs/xp/overview/>エクストリームプログラミングとは</a></li><li><a href=/agile-dev-guide/docs/xp/practice/>エクストリームプログラミングのプラクティス</a></li><li><a href=/agile-dev-guide/docs/xp/conclude/>まとめ</a></li></ul></li><li><input type=checkbox id=section-ef522355473a56c6b477dd934de57bb8 class=toggle>
<label for=section-ef522355473a56c6b477dd934de57bb8 class="flex justify-between"><a role=button>ソフトウェアテスト</a></label><ul><li><a href=/agile-dev-guide/docs/softwaretest/overview/>ソフトウェアテストを始めよう</a></li><li><a href=/agile-dev-guide/docs/softwaretest/fizzbuzz/>ウォーミングアップ</a></li><li><a href=/agile-dev-guide/docs/softwaretest/bowlinggame/>ボウリングゲーム</a></li><li><a href=/agile-dev-guide/docs/softwaretest/testdouble/>テストダブル</a></li><li><a href=/agile-dev-guide/docs/softwaretest/e2e/>E2Eテスト</a></li></ul></li><li><input type=checkbox id=section-c09385b1b773ce6e3a59f711992fc86e class=toggle>
<label for=section-c09385b1b773ce6e3a59f711992fc86e class="flex justify-between"><a role=button>ソフトウェア設計</a></label><ul><li><a href=/agile-dev-guide/docs/softwaredesign/about/>アジャイル開発に求められるソフトウェア設計</a></li><li><input type=checkbox id=section-af89c1e488b0f5f376cd7b5e25174bc5 class=toggle>
<label for=section-af89c1e488b0f5f376cd7b5e25174bc5 class="flex justify-between"><a role=button>SOLID原則</a></label><ul><li><a href=/agile-dev-guide/docs/softwaredesign/solidprinciple/srp/>単一責任の原則(SRP)</a></li><li><a href=/agile-dev-guide/docs/softwaredesign/solidprinciple/ocp/>オープン・クローズドの原則(OCP)</a></li><li><a href=/agile-dev-guide/docs/softwaredesign/solidprinciple/lsp/>リスコフの置換原則(LSP)</a></li><li><a href=/agile-dev-guide/docs/softwaredesign/solidprinciple/dip/>依存性逆転の原則(DIP)</a></li><li><a href=/agile-dev-guide/docs/softwaredesign/solidprinciple/isp/>インターフェース分離の原則(ISP)</a></li></ul></li><li><input type=checkbox id=section-866eec1f3dcfccd287cfe06fbdb82bb8 class=toggle>
<label for=section-866eec1f3dcfccd287cfe06fbdb82bb8 class="flex justify-between"><a role=button>デザインパターン</a></label><ul><li><a href=/agile-dev-guide/docs/softwaredesign/designpattern/designpattern/>デザインパターン</a></li></ul></li></ul></li><li><input type=checkbox id=section-ffa226df7ff6fdab04824ed978163e3a class=toggle checked>
<label for=section-ffa226df7ff6fdab04824ed978163e3a class="flex justify-between"><a role=button>アジャイルの実践</a></label><ul><li><a href=/agile-dev-guide/docs/practice/day1/>1日目</a></li><li><a href=/agile-dev-guide/docs/practice/day2/>2日目</a></li><li><a href=/agile-dev-guide/docs/practice/day3/>3日目</a></li><li><a href=/agile-dev-guide/docs/practice/day4/>4日目</a></li><li><a href=/agile-dev-guide/docs/practice/day5/ class=active>5日目</a></li><li><a href=/agile-dev-guide/docs/practice/day6/>6日目</a></li></ul></li><li><a href=/agile-dev-guide/docs/inclosing/>おわりに</a></li><li><a href=/agile-dev-guide/docs/recommendedbooks/>推奨書籍</a></li><li class=book-section-flat><span>全体編</span><ul><li><input type=checkbox id=section-c08c824050a314a836aa6f2a3533d6f4 class=toggle>
<label for=section-c08c824050a314a836aa6f2a3533d6f4 class="flex justify-between"><a role=button>リーンスタートアップアジャイル</a></label><ul><li><a href=/agile-dev-guide/docs/framework/leanstartup/overview/>リーンスタートアップアジャイルの流れ</a></li><li><a href=/agile-dev-guide/docs/framework/leanstartup/organization/>体制・役割</a></li><li><a href=/agile-dev-guide/docs/framework/leanstartup/productvision/>プロダクトビジョン / バリュープロポジション</a></li></ul></li><li><input type=checkbox id=section-4843f470e01d88c8920f705055d62d32 class=toggle>
<label for=section-4843f470e01d88c8920f705055d62d32 class="flex justify-between"><a role=button>モダナイゼーションアジャイル</a></label><ul><li><a href=/agile-dev-guide/docs/framework/modernization/overview/>モダナイゼーションアジャイルの流れ</a></li><li><a href=/agile-dev-guide/docs/framework/modernization/organization/>体制・役割</a></li><li><input type=checkbox id=section-16e7420deaec3bf622c47c912e4fe6b1 class=toggle>
<label for=section-16e7420deaec3bf622c47c912e4fe6b1 class="flex justify-between"><a role=button>Swift Method</a></label><ul><li><a href=/agile-dev-guide/docs/framework/modernization/swift/overview/>Swift Method とは</a></li><li><a href=/agile-dev-guide/docs/framework/modernization/swift/eventstorming/>Event Storming</a></li><li><a href=/agile-dev-guide/docs/framework/modernization/swift/boris/>Boris</a></li><li><a href=/agile-dev-guide/docs/framework/modernization/swift/snape/>SnapE</a></li><li><a href=/agile-dev-guide/docs/framework/modernization/swift/slices/>Slices</a></li><li><a href=/agile-dev-guide/docs/framework/modernization/swift/techchoice/>Tech Choice</a></li></ul></li></ul></li></ul></li><li class=book-section-flat><span>Team編</span><ul><li><a href=/agile-dev-guide/docs/team/workstyle/>チームの働き方</a></li><li><a href=/agile-dev-guide/docs/team/balancedteam/>バランスチーム</a></li><li><input type=checkbox id=section-a232289a72ea66e3aa7212c269a1f858 class=toggle>
<label for=section-a232289a72ea66e3aa7212c269a1f858 class="flex justify-between"><a role=button>マインドセット</a></label><ul><li><a href=/agile-dev-guide/docs/team/mindset/onebase/>ONEbaseの価値観</a></li><li><a href=/agile-dev-guide/docs/team/mindset/psychologicalsafety/>心理的安全性</a></li><li><a href=/agile-dev-guide/docs/team/mindset/xp/>XPの価値観</a></li><li><a href=/agile-dev-guide/docs/team/mindset/practice/>プラクティスの取り入れ方</a></li></ul></li><li><a href=/agile-dev-guide/docs/team/teambuilding/>チームビルディング</a></li><li><a href=/agile-dev-guide/docs/team/remotework/>リモートワーク</a></li><li><input type=checkbox id=section-110f9959d63e8c110b8745fc9d06c772 class=toggle>
<label for=section-110f9959d63e8c110b8745fc9d06c772 class="flex justify-between"><a role=button>チームのアクティビティ</a></label><ul><li><a href=/agile-dev-guide/docs/team/activities/officestandup/>全体スタンドアップ</a></li><li><a href=/agile-dev-guide/docs/team/activities/teamstandup/>チームスタンドアップ</a></li><li><a href=/agile-dev-guide/docs/team/activities/preipm/>Pre-IPM</a></li><li><a href=/agile-dev-guide/docs/team/activities/ipm/>IPM</a></li><li><a href=/agile-dev-guide/docs/team/activities/cl/>CLミーティング</a></li><li><a href=/agile-dev-guide/docs/team/activities/retro/>レトロスペクティブ</a></li><li><a href=/agile-dev-guide/docs/team/activities/salesmeeting/>営業確認会議</a></li><li><a href=/agile-dev-guide/docs/team/activities/internalsync/>Internal Sync</a></li><li><a href=/agile-dev-guide/docs/team/activities/riskmitigations/>Risks & Mitigations</a></li><li><a href=/agile-dev-guide/docs/team/activities/feedback/>フィードバック</a></li><li><a href=/agile-dev-guide/docs/team/activities/icebreak/>Ice Break</a></li><li><a href=/agile-dev-guide/docs/team/activities/teamhealthcheck/>Team Health Check</a></li><li><a href=/agile-dev-guide/docs/team/activities/1on1/>1on1</a></li><li><a href=/agile-dev-guide/docs/team/activities/exercise/>ラジオ体操</a></li></ul></li><li><input type=checkbox id=section-bdb63741ec425eaf58eeca20fa22f0f7 class=toggle>
<label for=section-bdb63741ec425eaf58eeca20fa22f0f7 class="flex justify-between"><a role=button>チームのプラクティス</a></label><ul><li><a href=/agile-dev-guide/docs/team/practices/facilitation/>ファシリテーション</a></li><li><a href=/agile-dev-guide/docs/team/practices/okrs/>OKRs</a></li></ul></li></ul></li><li class=book-section-flat><span>Designer編</span><ul><li><a href=/agile-dev-guide/docs/designer/overview/>Designerとは</a></li><li><input type=checkbox id=section-a01b867896ae9f1f3928ca93b2070a69 class=toggle>
<label for=section-a01b867896ae9f1f3928ca93b2070a69 class="flex justify-between"><a role=button>Designerのプラクティス</a></label><ul><li><a href=/agile-dev-guide/docs/designer/practices/persona/>ペルソナ</a></li><li><a href=/agile-dev-guide/docs/designer/practices/scenario/>シナリオ</a></li><li><a href=/agile-dev-guide/docs/designer/practices/researchplanning/>リサーチ計画立案</a></li><li><a href=/agile-dev-guide/docs/designer/practices/prototyping/>プロトタイピング</a></li><li><a href=/agile-dev-guide/docs/designer/practices/script/>スクリプト作成</a></li><li><a href=/agile-dev-guide/docs/designer/practices/researchaction/>リサーチ実施</a></li><li><a href=/agile-dev-guide/docs/designer/practices/synthesize/>シンセサイズ</a></li></ul></li></ul></li><li class=book-section-flat><span>Product Manager編</span><ul><li><a href=/agile-dev-guide/docs/productmanager/overview/>Product Managerとは</a></li><li><input type=checkbox id=section-d59afdd8070324cbcc7435686b4f2086 class=toggle>
<label for=section-d59afdd8070324cbcc7435686b4f2086 class="flex justify-between"><a role=button>Product Managerのプラクティス</a></label><ul><li><a href=/agile-dev-guide/docs/productmanager/practices/roadmap/>プロダクトロードマップ</a></li><li><a href=/agile-dev-guide/docs/productmanager/practices/mvp/>MVP</a></li><li><a href=/agile-dev-guide/docs/productmanager/practices/userstorymapping/>ユーザーストーリーマッピング</a></li><li><a href=/agile-dev-guide/docs/productmanager/practices/userstory/>ユーザーストーリー</a></li><li><a href=/agile-dev-guide/docs/productmanager/practices/2x2/>2×2</a></li></ul></li></ul></li><li class=book-section-flat><span>Developer編</span><ul><li><a href=/agile-dev-guide/docs/developer/overview/>Developerとは</a></li><li><input type=checkbox id=section-efb8318f4d88b390e60e256084f8f4ac class=toggle>
<label for=section-efb8318f4d88b390e60e256084f8f4ac class="flex justify-between"><a role=button>Developerのプラクティス</a></label><ul><li><a href=/agile-dev-guide/docs/developer/practices/tdd/>TDD</a></li><li><a href=/agile-dev-guide/docs/developer/practices/cicd/>CI/CD</a></li><li><a href=/agile-dev-guide/docs/developer/practices/pairprogramming/>ペアプログラミング</a></li><li><a href=/agile-dev-guide/docs/developer/practices/soroprogramming/>ソロプログラミング</a></li></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/agile-dev-guide/svg/menu.svg class=book-icon alt=Menu></label><h3>5日目</h3><label for=toc-control><img src=/agile-dev-guide/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#タスク作成バックエンドapi>タスク作成バックエンドAPI</a><ul><li><a href=#テスト>テスト</a></li><li><a href=#実装>実装</a></li><li><a href=#再実行可能なテスト>再実行可能なテスト</a></li></ul></li><li><a href=#タスク画面のデザインの適用>タスク画面のデザインの適用</a></li><li><a href=#api設計>API設計</a><ul><li><a href=#いいapiの設計とは>いいAPIの設計とは</a></li><li><a href=#リソース志向設計>リソース志向設計</a></li><li><a href=#パラメータ>パラメータ</a></li><li><a href=#レスポンス設計>レスポンス設計</a></li><li><a href=#クライアントに忖度しない>クライアントに忖度しない</a></li><li><a href=#swaggeroas30>Swagger(OAS3.0)</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=5日目>5日目
<a class=anchor href=#5%e6%97%a5%e7%9b%ae>#</a></h1><p>ではTodoを作成するバックエンドAPIを作成していきましょう。</p><h2 id=タスク作成バックエンドapi>タスク作成バックエンドAPI
<a class=anchor href=#%e3%82%bf%e3%82%b9%e3%82%af%e4%bd%9c%e6%88%90%e3%83%90%e3%83%83%e3%82%af%e3%82%a8%e3%83%b3%e3%83%89api>#</a></h2><h3 id=テスト>テスト
<a class=anchor href=#%e3%83%86%e3%82%b9%e3%83%88>#</a></h3><p>まず、サーバのテストを書いてみましょう。
<code>POST /todos</code>に対してJSONをボディにセットして、リクエストしたときの、 レスポンスコードとレスポンスデータを確認するテストを書いてみます。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// TodoControllerTest.kt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>package</span> com.fujitsu.todoappserver.controller
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fasterxml.jackson.module.kotlin.jacksonObjectMapper
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fasterxml.jackson.module.kotlin.readValue
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.model.Todo
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.assertj.core.api.Assertions.assertThat
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.json.JSONObject
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.junit.jupiter.api.Test
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.beans.factory.annotation.Autowired
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.boot.test.context.SpringBootTest
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.boot.test.web.client.TestRestTemplate
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.http.*
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@SpringBootTest</span>(webEnvironment = <span style=color:#a6e22e>SpringBootTest</span>.<span style=color:#a6e22e>WebEnvironment</span>.RANDOM_PORT)
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TodoControllerTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>lateinit</span> <span style=color:#66d9ef>var</span> restTemplate: TestRestTemplate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>タスク一覧を取得できる</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> header = HttpHeaders()
</span></span><span style=display:flex><span>        header.contentType = <span style=color:#a6e22e>MediaType</span>.APPLICATION_JSON
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> response = restTemplate.exchange(<span style=color:#e6db74>&#34;/todos&#34;</span>, <span style=color:#a6e22e>HttpMethod</span>.GET, HttpEntity(<span style=color:#66d9ef>null</span>, header), String<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> mapper = jacksonObjectMapper()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> articles: List&lt;Todo&gt; = mapper.readValue(response.body<span style=color:#f92672>!!</span>)
</span></span><span style=display:flex><span>        assertThat(response.statusCode).isEqualTo(<span style=color:#a6e22e>HttpStatus</span>.OK)
</span></span><span style=display:flex><span>        assertThat(articles.size).isEqualTo(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>タスクを新規作成できる</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> newTodoJson = JSONObject()
</span></span><span style=display:flex><span>        newTodoJson.put(<span style=color:#e6db74>&#34;title&#34;</span>, <span style=color:#e6db74>&#34;test title&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> header = HttpHeaders()
</span></span><span style=display:flex><span>        header.contentType = <span style=color:#a6e22e>MediaType</span>.APPLICATION_JSON
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> postResponse = restTemplate.exchange(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;/todos&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>HttpMethod</span>.POST,
</span></span><span style=display:flex><span>            HttpEntity(newTodoJson.toString(), header),
</span></span><span style=display:flex><span>            String<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> mapper = jacksonObjectMapper()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> todo: Todo = mapper.readValue(postResponse.body<span style=color:#f92672>!!</span>)
</span></span><span style=display:flex><span>        assertThat(postResponse.statusCode).isEqualTo(<span style=color:#a6e22e>HttpStatus</span>.CREATED)
</span></span><span style=display:flex><span>        assertThat(todo.id).isEqualTo(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        assertThat(todo.title).isEqualTo(<span style=color:#e6db74>&#34;test title&#34;</span>)
</span></span><span style=display:flex><span>        assertThat(todo.completed).isEqualTo(<span style=color:#66d9ef>false</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>これは先日書いた<code>Get /Todos</code>のテストと同等なので大丈夫でしょう。</p><h3 id=実装>実装
<a class=anchor href=#%e5%ae%9f%e8%a3%85>#</a></h3><p>これも先日実装した<code>Get /Todos</code>とほぼ同等ですので、コードだけ示します。</p><h4 id=model>Model
<a class=anchor href=#model>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// NewTodo.kt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>package</span> com.fujitsu.todoappserver.model
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>data</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>NewTodo</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>val</span> title: String,
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><h4 id=controller層>Controller層
<a class=anchor href=#controller%e5%b1%a4>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// TodoControllerInterface.kt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>package</span> com.fujitsu.todoappserver.controller
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.model.NewTodo  <span style=color:#75715e>// 追加
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.model.Todo
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>TodoControllerInterface</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getTodos</span>(): List&lt;Todo&gt;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>createTodo</span>(newTodo: NewTodo): Todo  <span style=color:#75715e>// 追加
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// TodoController.kt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>package</span> com.fujitsu.todoappserver.controller
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.model.NewTodo
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.model.Todo
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.http.HttpStatus
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.web.bind.annotation.*
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@RestController</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TodoController</span>(<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>val</span> todoService: TodoControllerInterface) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@GetMapping</span>(<span style=color:#e6db74>&#34;/todos&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@ResponseStatus</span>(<span style=color:#a6e22e>HttpStatus</span>.OK)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getTodos</span>(): List&lt;Todo&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> todoService.getTodos()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 追加
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>@PostMapping</span>(<span style=color:#e6db74>&#34;/todos&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@ResponseStatus</span>(<span style=color:#a6e22e>HttpStatus</span>.CREATED)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>createTodo</span>(<span style=color:#a6e22e>@RequestBody</span> newTodo: NewTodo): Todo {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> todoService.createTodo(newTodo)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=service層>Service層
<a class=anchor href=#service%e5%b1%a4>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// TodoServiceInterface.kt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>package</span> com.fujitsu.todoappserver.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.model.NewTodo  <span style=color:#75715e>// 追加
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.model.Todo
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>TodoServiceInterface</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getTodos</span>(): List&lt;Todo&gt;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>createTodo</span>(newTodo: NewTodo): Todo      <span style=color:#75715e>// 追加
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// TodoService.kt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>package</span> com.fujitsu.todoappserver.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.controller.TodoControllerInterface
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.model.NewTodo  <span style=color:#75715e>// 追加
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.model.Todo
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.stereotype.Service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Service</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TodoService</span>(<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>val</span> todoRepository: TodoServiceInterface) : TodoControllerInterface {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getTodos</span>(): List&lt;Todo&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> todoRepository.getTodos()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 追加
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>createTodo</span>(newTodo: NewTodo): Todo {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> todoRepository.createTodo(newTodo)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h5 id=repository層>Repository層
<a class=anchor href=#repository%e5%b1%a4>#</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// TodoRepository.kt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>package</span> com.fujitsu.todoappserver.repository
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.model.NewTodo  <span style=color:#75715e>// 追加
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.model.Todo
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.service.TodoServiceInterface
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.jdbc.core.JdbcTemplate
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.jdbc.support.GeneratedKeyHolder
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.stereotype.Repository
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> java.sql.ResultSet
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> java.sql.Statement
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Repository</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TodoRepository</span>(<span style=color:#66d9ef>val</span> jdbcTemplate: JdbcTemplate) : TodoServiceInterface {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getTodos</span>(): List&lt;Todo&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> jdbcTemplate.query(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;&#34;&#34;select id, title, completed from todo&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        ) { rs: ResultSet, _: Int <span style=color:#f92672>-&gt;</span>
</span></span><span style=display:flex><span>            Todo(
</span></span><span style=display:flex><span>                rs.getInt(<span style=color:#e6db74>&#34;id&#34;</span>),
</span></span><span style=display:flex><span>                rs.getString(<span style=color:#e6db74>&#34;title&#34;</span>),
</span></span><span style=display:flex><span>                rs.getBoolean(<span style=color:#e6db74>&#34;completed&#34;</span>)
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 追加
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>createTodo</span>(newTodo: NewTodo): Todo {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> keyHolder = GeneratedKeyHolder()
</span></span><span style=display:flex><span>        jdbcTemplate.update({ connection <span style=color:#f92672>-&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>val</span> statement = connection.prepareStatement(
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;&#34;&#34;insert into todo(title, completed) values (?, false)&#34;&#34;&#34;</span>, <span style=color:#a6e22e>Statement</span>.RETURN_GENERATED_KEYS
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>            statement.setString(<span style=color:#ae81ff>1</span>, newTodo.title)
</span></span><span style=display:flex><span>            statement
</span></span><span style=display:flex><span>        }, keyHolder)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> Todo(
</span></span><span style=display:flex><span>            keyHolder.keys<span style=color:#f92672>!!</span>[<span style=color:#e6db74>&#34;id&#34;</span>] <span style=color:#66d9ef>as</span> Int,
</span></span><span style=display:flex><span>            newTodo.title,
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>リポジトリは少しテクニカルなことをしていて、insert文を実行したときにインクリメントされた<code>id</code>を返すようにしていて、 それを使って、戻り値を返すようにしています。</p><p>こうすると、データを作成した後にサイドselect文を発行する必要がなくなりレスポンスが早くなります。</p><h3 id=再実行可能なテスト>再実行可能なテスト
<a class=anchor href=#%e5%86%8d%e5%ae%9f%e8%a1%8c%e5%8f%af%e8%83%bd%e3%81%aa%e3%83%86%e3%82%b9%e3%83%88>#</a></h3><p>さて、実装は完了したのでテストを動かして検証していきたいわけですが、このテストは問題なく動いているでしょうか？ このテストはデータベースの状態に強く依存していて、動く人もいれば動かない人もいます。
もし、運良くテストが動いた人も、もう一度全件テストを動かすと失敗するはずです。</p><p>これはテストを実行する度に、todo_dbに対してデータの追加を行っているからで、 一度todoテーブルに対してデータを追加すると、2回目以降はidが1にはならないからです。 つまり、これは再現可能なテストになっていません。</p><p>この問題に対処するにはテストを実行する度にDBをリセットしてしまえばいいので、その設定をしてみましょう。</p><p>まず、src/test配下に<code>resources</code>ディレクトリを作成し、その中に<code>clear_db.sql</code>を作成します。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>/* clear_db.sql */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>truncate</span> <span style=color:#66d9ef>table</span> todo <span style=color:#66d9ef>restart</span> <span style=color:#66d9ef>identity</span> <span style=color:#66d9ef>cascade</span>;
</span></span></code></pre></div><p>やっている内容は単純でtodoテーブルの内容をtruncateすると共に、idのシーケンスをリセットしています。 そして、テストを実行する度にこのSQLを実行したらいいわけですが、これもアノテーションを付与するだけで簡単に実現できます。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// TodoControllerTest.kt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>package</span> com.fujitsu.todoappserver.controller
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fasterxml.jackson.module.kotlin.jacksonObjectMapper
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fasterxml.jackson.module.kotlin.readValue
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> com.fujitsu.todoappserver.model.Todo
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.assertj.core.api.Assertions.assertThat
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.json.JSONObject
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.junit.jupiter.api.Test
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.beans.factory.annotation.Autowired
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.boot.test.context.SpringBootTest
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.boot.test.web.client.TestRestTemplate
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.http.*
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> org.springframework.test.context.jdbc.Sql    <span style=color:#75715e>// 追加
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@SpringBootTest</span>(webEnvironment = <span style=color:#a6e22e>SpringBootTest</span>.<span style=color:#a6e22e>WebEnvironment</span>.RANDOM_PORT)
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Sql</span>(scripts = [<span style=color:#e6db74>&#34;/clear_db.sql&#34;</span>])       <span style=color:#75715e>// 追加
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TodoControllerTest</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>lateinit</span> <span style=color:#66d9ef>var</span> restTemplate: TestRestTemplate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>タスク一覧を取得できる</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> header = HttpHeaders()
</span></span><span style=display:flex><span>        header.contentType = <span style=color:#a6e22e>MediaType</span>.APPLICATION_JSON
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> response = restTemplate.exchange(<span style=color:#e6db74>&#34;/todos&#34;</span>, <span style=color:#a6e22e>HttpMethod</span>.GET, HttpEntity(<span style=color:#66d9ef>null</span>, header), String<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> mapper = jacksonObjectMapper()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> articles: List&lt;Todo&gt; = mapper.readValue(response.body<span style=color:#f92672>!!</span>)
</span></span><span style=display:flex><span>        assertThat(response.statusCode).isEqualTo(<span style=color:#a6e22e>HttpStatus</span>.OK)
</span></span><span style=display:flex><span>        assertThat(articles.size).isEqualTo(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>タスクを新規作成できる</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> newTodoJson = JSONObject()
</span></span><span style=display:flex><span>        newTodoJson.put(<span style=color:#e6db74>&#34;title&#34;</span>, <span style=color:#e6db74>&#34;test title&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> header = HttpHeaders()
</span></span><span style=display:flex><span>        header.contentType = <span style=color:#a6e22e>MediaType</span>.APPLICATION_JSON
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> postResponse = restTemplate.exchange(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;/todos&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>HttpMethod</span>.POST,
</span></span><span style=display:flex><span>            HttpEntity(newTodoJson.toString(), header),
</span></span><span style=display:flex><span>            String<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> mapper = jacksonObjectMapper()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> todo: Todo = mapper.readValue(postResponse.body<span style=color:#f92672>!!</span>)
</span></span><span style=display:flex><span>        assertThat(postResponse.statusCode).isEqualTo(<span style=color:#a6e22e>HttpStatus</span>.CREATED)
</span></span><span style=display:flex><span>        assertThat(todo.id).isEqualTo(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        assertThat(todo.title).isEqualTo(<span style=color:#e6db74>&#34;test title&#34;</span>)
</span></span><span style=display:flex><span>        assertThat(todo.completed).isEqualTo(<span style=color:#66d9ef>false</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>これでテストは動くはずです。データを追加できるようになったため、データを追加した後Getでレスポンスデータを確認するテストを追記しても良いでしょう。</p><p>ここまでのサーバのソースコードは
<a href=https://github.com/onebase-fujitsu/todo-app-vite/tree/feature/step10>https://github.com/onebase-fujitsu/todo-app-vite/tree/feature/step10</a>
においてあります。</p><h2 id=タスク画面のデザインの適用>タスク画面のデザインの適用
<a class=anchor href=#%e3%82%bf%e3%82%b9%e3%82%af%e7%94%bb%e9%9d%a2%e3%81%ae%e3%83%87%e3%82%b6%e3%82%a4%e3%83%b3%e3%81%ae%e9%81%a9%e7%94%a8>#</a></h2><p><img src=NewTask.jpg alt=NewTask></p><p>現在クライアントを連携させると、NewTask画面で追加したタスクがHome画面に追加できていることがわかります。 しかし、デザインがまだ適用されていないので、デザインを適用してみましょう。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// TodoList.tsx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>styled</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;styled-components&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> {<span style=color:#a6e22e>TodoContext</span>} <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../context/TodoContext&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Ul</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>styled</span>.<span style=color:#a6e22e>ul</span><span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  width: 100%;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  padding: 2rem;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  display: flex;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  flex-direction: column;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Li</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>styled</span>.<span style=color:#a6e22e>li</span><span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  width: 100%;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  display: flex;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  justify-content: center;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  align-items: center;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  padding-bottom: 1rem;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Div</span> <span style=color:#f92672>=</span><span style=color:#a6e22e>styled</span>.<span style=color:#a6e22e>div</span><span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  width: 100%;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  display: flex;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  border-width: 2px;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  border-style: solid;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  border-color: #E5E7EB;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  border-radius: 0.5rem;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  padding: 1rem;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  box-shadow: 0 1px 5px 2px rgb(0 0 0 / 0.1);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Label</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>styled</span>.<span style=color:#a6e22e>label</span><span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  display: inline-flex;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  align-items: center;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  margin-right: 1rem;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Input</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>styled</span>.<span style=color:#a6e22e>input</span><span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  height: 1.25rem;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  width: 1.25rem;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  color: #4B5563;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>P</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>styled</span>.<span style=color:#a6e22e>p</span><span style=color:#e6db74>`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  font-size: 1.25rem;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  line-height: 1.75rem;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  font-weight: 700;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>TodoList</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>todoContext</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>useContext</span>(<span style=color:#a6e22e>TodoContext</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>Ul</span> <span style=color:#a6e22e>data-testid</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;TodoList&#34;</span>&gt;
</span></span><span style=display:flex><span>      {<span style=color:#a6e22e>todoContext</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>todos</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>todo</span>) <span style=color:#f92672>=&gt;</span> (
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Li</span> <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>todo</span>.<span style=color:#a6e22e>id</span>}&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>Div</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>Label</span>&gt;
</span></span><span style=display:flex><span>              &lt;<span style=color:#f92672>Input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;checkbox&#34;</span> <span style=color:#a6e22e>defaultChecked</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>todo</span>.<span style=color:#a6e22e>completed</span>}/&gt;
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>Label</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>P</span>&gt;{<span style=color:#a6e22e>todo</span>.<span style=color:#a6e22e>title</span>}&lt;/<span style=color:#f92672>P</span>&gt;
</span></span><span style=display:flex><span>          &lt;/<span style=color:#f92672>Div</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>Li</span>&gt;
</span></span><span style=display:flex><span>      ))}
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>Ul</span>&gt;
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>TodoList</span>
</span></span></code></pre></div><p>タスクリストにデザインを適用してみました。</p><p><img src=DesignedTaskList.jpg alt=DesignedTaskList></p><p>ここまでのクライアントのソースコードは
<a href=https://github.com/onebase-fujitsu/todo-app-vite/tree/feature/step11>https://github.com/onebase-fujitsu/todo-app-vite/tree/feature/step11</a>
に置いてあります。</p><h2 id=api設計>API設計
<a class=anchor href=#api%e8%a8%ad%e8%a8%88>#</a></h2><p>さて、ここまで<code>/todos</code>に対するGETの処理やPOSTの処理を実装しましたが、 ここで少し箸休めにAPIの設計について簡単に説明しようと思います。</p><p>とはいえAPI設計だけで本一冊書けるぐらいに奥が深い内容で、ここでは本当にさわりを紹介する程度にとどめます。 現代のWebアプリケーション開発に置いてAPI設計スキルはほぼ必須で避けて通ることはできませんので、
<a href=https://www.oreilly.co.jp/books/9784873116860/>Web API: The Good Parts</a> 等の書籍を各自読みましょう。</p><h3 id=いいapiの設計とは>いいAPIの設計とは
<a class=anchor href=#%e3%81%84%e3%81%84api%e3%81%ae%e8%a8%ad%e8%a8%88%e3%81%a8%e3%81%af>#</a></h3><p>4日目に以下のような文書を記載しました。</p><blockquote class=book-hint>HTTP通信のオーバーヘッドはメモリアクセスや、ディスクアクセスと比較して比べ物にならないほど大きいです。 良くないAPIを揶揄する言葉に「おしゃべりなAPI」というものがあります。
つまり、画面を描画するのになんどもなんどもAPIをコールする必要があるAPI設計は良くないということです。</blockquote><p>これはよくある悪いAPIの設計の話なのですが、逆にいいAPIとはなんでしょうか？</p><p>いいAPIの定義は人によって様々だと思いますが、筆者は <strong>「開発者がドキュメントを見なくても自然に使えるAPI」</strong> がいいAPIだと思っています。 自然に使えるというのは <strong>つまりWeb標準に従っているAPI</strong>
ということです。つまりRESTのアーキテクチャに従って設計しなさいということになります。</p><h3 id=リソース志向設計>リソース志向設計
<a class=anchor href=#%e3%83%aa%e3%82%bd%e3%83%bc%e3%82%b9%e5%bf%97%e5%90%91%e8%a8%ad%e8%a8%88>#</a></h3><p>RESTのキーとなる概念は<strong>論理的に分割されたリソースをHTTPメソッド(GET/POST/PUT/DELETE)で操作する</strong>ということです。
RESTではURL部分を「リソース」とみなし、HTTPメソッドとURLの組み合わせを「なにを(リソース)」「どうする(メソッド)」という形式で捉えます。</p><h4 id=リソース>リソース
<a class=anchor href=#%e3%83%aa%e3%82%bd%e3%83%bc%e3%82%b9>#</a></h4><p>リソースとはURLで表現されるAPIによって操作される対象のことです。 たとえば、今回のアプリケーションであればTodoがリソースに当たります。</p><h4 id=メソッド>メソッド
<a class=anchor href=#%e3%83%a1%e3%82%bd%e3%83%83%e3%83%89>#</a></h4><p>HTTPのメソッドは主に5つです。</p><table><thead><tr><th style=text-align:left>メソッドの種類</th><th style=text-align:left>役割</th></tr></thead><tbody><tr><td style=text-align:left>GET</td><td style=text-align:left>リソースの取得</td></tr><tr><td style=text-align:left>POST</td><td style=text-align:left>リソースの新規作成</td></tr><tr><td style=text-align:left>PATCH</td><td style=text-align:left>リソースの一分更新</td></tr><tr><td style=text-align:left>PUT</td><td style=text-align:left>リソースの置き換え</td></tr><tr><td style=text-align:left>DELETE</td><td style=text-align:left>リソースの削除</td></tr></tbody></table><p>これらのメソッドを使って、リソースに対する操作を表現していきます。 例えば今回のタスク管理アプリケーションですと、以下のようになります。</p><ul><li>GET /todos<ul><li>Todoのリストを取得する</li></ul></li><li>GET /todos/1<ul><li>Todo#1を取得する</li></ul></li><li>POST /todos<ul><li>新規のTodoを作成する</li></ul></li><li>PUT /todos/2<ul><li>Todo#2を更新する</li></ul></li><li>DELETE /todos/3<ul><li>Todo#3を削除する</li></ul></li></ul><p>RESTはHTTPメソッドを活用することで、<code>/todos</code>というエンドポイントに対して主要な機能をもたせることができます。 リソースに対する命令をHTTPのメソッドで表現するという形です。
こうすることで、エンドポイントの命名規則など意識する必要ありませんし、URL 構造は明白かつ整然としたものとなります。</p><p>Todoに関連データがあった場合はどうでしょうか。例えば1つのTodoには複数のタスクから構成されるといったリソースを考えてみましょう。 その場合は以下のように表現されるのが自然です。</p><ul><li>GET /todos/1/tasks<ul><li>Todo#1に紐づくタスクのリストを取得する</li></ul></li><li>GET /todos/1/tasks/5<ul><li>Todo#1に紐づくタスク#5を取得する</li></ul></li><li>POST /todos/1/tasks<ul><li>Todo#1に紐づくタスクを新規作成する</li></ul></li><li>PUT /todos/1/tasks/4<ul><li>Todo#1に紐づくタスク#4を更新する</li></ul></li><li>PATCH /todos/1<ul><li>Todo#1のリソースを部分的に更新する</li></ul></li><li>DELETE /todos/1/tasks/2<ul><li>Todo#1に紐づくタスク#2を削除する</li></ul></li></ul><h3 id=パラメータ>パラメータ
<a class=anchor href=#%e3%83%91%e3%83%a9%e3%83%a1%e3%83%bc%e3%82%bf>#</a></h3><p>クライアントからサーバに対してAPIリクエストをする際に、クライアントからサーバに渡すことができるパラメータは3つあります。</p><ul><li>パスパラメータ</li><li>クエリパラメータ</li><li>リクエストボディ</li></ul><p>それぞれどのように使うのが適当かについて説明していきましょう。</p><h4 id=クエリパラメータ>クエリパラメータ
<a class=anchor href=#%e3%82%af%e3%82%a8%e3%83%aa%e3%83%91%e3%83%a9%e3%83%a1%e3%83%bc%e3%82%bf>#</a></h4><p>クエリパラメータはクエリという名前の示すとおり、<strong>リソースの絞り込みに使う</strong> ものです。</p><pre tabindex=0><code>GET /todos?completed=false
</code></pre><p>このようにURLに<code>?</code>続くかたちでパラメータを与えることができます。 ここで大事なのは絞り込みの用途で使われるべきであるということです。</p><p><code>GET /todos</code>というAPIはTodo一覧を返すわけですが、その一覧の要素をクエリパラメータを使って絞り込む用途で使います。
<code>GET /todos?completed=false</code>という命令は/todosの中から未完了のものだけをリストで返してほしいという命令になるわけです。</p><p>取得リソースの絞り込みにつかうため、必然的に<strong>GETメソッド以外ではクエリパラメータを使うことはありません。</strong></p><h4 id=パスパラメータ>パスパラメータ
<a class=anchor href=#%e3%83%91%e3%82%b9%e3%83%91%e3%83%a9%e3%83%a1%e3%83%bc%e3%82%bf>#</a></h4><p><strong>パスパラーメタはリソースの指定をおこなう</strong> ためのものです。 先程、<code>GET /todos/1</code>という例をだしましたが、これはTodo#1を取得するという命令でした。 このurlに含まれる<code>1</code>
というのはクライアントが指定できるパラメータで、 汎用的に書くとつまり<code>GET /todos/${id}</code>という形で記述することができます。 パスに入れることで、特定のリソースに対する命令であることを明確にしていることがわかると思います。</p><p>クエリパラメータは原則GETメソッドでしか使えませんでしたが、パスパラメータはどのようなメソッドでも使うことができます。 パスパラメータが設定されているエンドポイントにおいて、パスパラメータは原則必須になるという特徴も覚えておいてください。
つまり<code>GET /todos/</code>のような宣言は許可されません。</p><h4 id=リクエストボディ>リクエストボディ
<a class=anchor href=#%e3%83%aa%e3%82%af%e3%82%a8%e3%82%b9%e3%83%88%e3%83%9c%e3%83%87%e3%82%a3>#</a></h4><p><strong>リクエストボディはリソースの作成や、置換を行う際に、その内容を記載するものです。</strong></p><p>例えば、<code>POST /todos</code>のAPIを実行たときのリクエストボディは以下のようになっていました。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;title&#34;</span>: <span style=color:#e6db74>&#34;Sample Title&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>基本的にはJSON形式を使うことが一般的です。JSON文書であればClientもServerも取り扱いです。 また、ファイルのアップロードなどを取り扱う場合はmultipart/form-dataといった形式が取られます。</p><h3 id=レスポンス設計>レスポンス設計
<a class=anchor href=#%e3%83%ac%e3%82%b9%e3%83%9d%e3%83%b3%e3%82%b9%e8%a8%ad%e8%a8%88>#</a></h3><h4 id=レスポンスステータス>レスポンスステータス
<a class=anchor href=#%e3%83%ac%e3%82%b9%e3%83%9d%e3%83%b3%e3%82%b9%e3%82%b9%e3%83%86%e3%83%bc%e3%82%bf%e3%82%b9>#</a></h4><p>APIにおいてとても大事なことはHTTPSレスポンスステータスコードをフル活用することです。 HTTPレスポンスステータスコードが何かわからない方もWebブラウザで404 Not
Foundが表示されたことがあるのを見たことがない人はいないと思います。</p><p>APIがクライアントにレスポンスを返すときに適切なステータスコードを返すようにする必要があります。</p><table><thead><tr><th style=text-align:left>ステータスコード</th><th style=text-align:left>意味</th></tr></thead><tbody><tr><td style=text-align:left>200 OK</td><td style=text-align:left>リクエスト成功</td></tr><tr><td style=text-align:left>201 CREATED</td><td style=text-align:left>リクエストに成功し、リソースを作成</td></tr><tr><td style=text-align:left>204 NO CONTENT</td><td style=text-align:left>リクエストは成功、返すコンテンツはない</td></tr><tr><td style=text-align:left>400 BAD REQUEST</td><td style=text-align:left>リクエストの形式エラー(クライアントのリクエストの誤り)</td></tr><tr><td style=text-align:left>401 UNAUTHORIZED</td><td style=text-align:left>未承認エラー</td></tr><tr><td style=text-align:left>403 FORBIDDEN</td><td style=text-align:left>権限エラー</td></tr><tr><td style=text-align:left>404 NOT FOUND</td><td style=text-align:left>リソースがない</td></tr><tr><td style=text-align:left>500 Internal Server Error</td><td style=text-align:left>サーバーエラー</td></tr></tbody></table><p>よく使われるのはこの辺になります。ステータスコードを適切に返すことで、 クライアントはレスポンスボディをみなくても、リクエストが成功したのか、失敗したときなぜ失敗したのかがわかるようになります。</p><p>どういったステータスコードがあるのかは
<a href=https://developer.mozilla.org/ja/docs/Web/HTTP/Status>https://developer.mozilla.org/ja/docs/Web/HTTP/Status</a>
をみて、適切なものを選ぶようにしてください</p><h4 id=レスポンスデータの設計>レスポンスデータの設計
<a class=anchor href=#%e3%83%ac%e3%82%b9%e3%83%9d%e3%83%b3%e3%82%b9%e3%83%87%e3%83%bc%e3%82%bf%e3%81%ae%e8%a8%ad%e8%a8%88>#</a></h4><h5 id=リストを返すエンドポイント>リストを返すエンドポイント
<a class=anchor href=#%e3%83%aa%e3%82%b9%e3%83%88%e3%82%92%e8%bf%94%e3%81%99%e3%82%a8%e3%83%b3%e3%83%89%e3%83%9d%e3%82%a4%e3%83%b3%e3%83%88>#</a></h5><p>レスポンスデータは基本的にJSONで返すようにします。少し前まではXMLも使われることが多かったですが、今はJSON一択でよいです。 たとえば、<code>GET /todos</code>
にアクセスした場合、このエンドポイントはリストを返すエンドポイントですので、以下のようなレスポンスを返すように設計すると良いです。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>[
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;title&#34;</span>: <span style=color:#e6db74>&#34;todo title#1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;completed&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;title&#34;</span>: <span style=color:#e6db74>&#34;todo title#2&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;completed&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;title&#34;</span>: <span style=color:#e6db74>&#34;todo title#3&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;completed&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><p>リストのエンドポイントを設計する際にエンベロープにくるむべきかそうしないべきかは議論が分かれるところです。 エンベロープとは以下のようなものです。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;todos&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;title&#34;</span>: <span style=color:#e6db74>&#34;todo title#1&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;completed&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;title&#34;</span>: <span style=color:#e6db74>&#34;todo title#2&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;completed&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;title&#34;</span>: <span style=color:#e6db74>&#34;todo title#3&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;completed&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>しかし、筆者はエンベロープは不要と考えています。クライアントはTodoのリストを取得したくて、<code>GET /todos</code>にアクセスしているのですから、
リストがTodoのリストであることは自明であるためです。</p><h5 id=オブジェクトを返すエンドポイント>オブジェクトを返すエンドポイント
<a class=anchor href=#%e3%82%aa%e3%83%96%e3%82%b8%e3%82%a7%e3%82%af%e3%83%88%e3%82%92%e8%bf%94%e3%81%99%e3%82%a8%e3%83%b3%e3%83%89%e3%83%9d%e3%82%a4%e3%83%b3%e3%83%88>#</a></h5><p><code>GET /todos/1</code>というように特定のリソースを取得するようなエンドポイントの場合は、
配列ではなくオブジェクトを返すのが適当です。
即ち、いかのようなレスポンスボディを返すと良いです。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;title&#34;</span>: <span style=color:#e6db74>&#34;todo title#1&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;completed&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=レスポンス設計の難しさ>レスポンス設計の難しさ
<a class=anchor href=#%e3%83%ac%e3%82%b9%e3%83%9d%e3%83%b3%e3%82%b9%e8%a8%ad%e8%a8%88%e3%81%ae%e9%9b%a3%e3%81%97%e3%81%95>#</a></h4><p>では、Todoのリストが空だった場合はどういったレスポンスを返すべきでしょうか？
404を返すべきでしょうか？200で空のリストを返すべきでしょうか？</p><p>これも議論が分かれるところですが、筆者はレスポンスステータス200で空の配列を返すべきだと考えています。</p><p>では<code>GET /todos/13</code>というリクエストに対して、該当するTodoがない場合はどうでしょう？</p><p>これは筆者は404を返すのが適当かなと思います。リソースを指定して取得してきてるリクエストに対して、そのリソースがないと返すのが自然なためです。</p><p>では<code>GET /todos?id=13</code>というリクエストに対して、該当するTodoがない場合はどうでしょうか？
404 Not Foundを返すのが適当でしょうか？400 Bad Requestを返すのが適当でしょうか？200で空の配列を返すのが正しいでしょうか？</p><p>これも難しいところではありますが、200で空の配列を返すのが正しいと考えます。
リクエスト自体は正しいのですが、クエリの結果配列が空になってしまったという考え方になります。</p><p>このようにGETリクエスト一つとっても条件に応じて様々な考慮が必要になります。</p><h3 id=クライアントに忖度しない>クライアントに忖度しない
<a class=anchor href=#%e3%82%af%e3%83%a9%e3%82%a4%e3%82%a2%e3%83%b3%e3%83%88%e3%81%ab%e5%bf%96%e5%ba%a6%e3%81%97%e3%81%aa%e3%81%84>#</a></h3><p>APIのレスポンスデータを設計するにあたって一つ大事なポイントにクライアントに忖度しないというのがあります。
これはどういうことかというと、<strong>一般的なデータ表現で、多くの情報を一度に返す</strong>ということです。</p><h4 id=一般的なデータ形式を使う>一般的なデータ形式を使う
<a class=anchor href=#%e4%b8%80%e8%88%ac%e7%9a%84%e3%81%aa%e3%83%87%e3%83%bc%e3%82%bf%e5%bd%a2%e5%bc%8f%e3%82%92%e4%bd%bf%e3%81%86>#</a></h4><p>例えば、クライアントの画面でTodoの作成日付を「2021年11月10日　13時20分」のように出力するという要件があったとします。
このとき、サーバはどういったデータ表現で日時情報を表すべきでしょうか？</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>[
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;title&#34;</span>: <span style=color:#e6db74>&#34;todo title#1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;completed&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;createdAt&#34;</span>: <span style=color:#e6db74>&#34;2021年11月10日　13時20分&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><p>このようなJSONのレスポンスデータ設計は不適切です。というのも、Viewはアプリケーションの中でも特に変更の頻度が大きい部分です。
もし、このようなJSONレスポンスをしてしまうと、日付の表示形態を変更したいとなったときに、クライアントだけでなくサーバも影響を受けて変更しないといけなくなります。
データをうけてどのように表示するかを担うのはViewの部分。即ちClientになります。サーバはそれに忖度してはいけません。
例えば日時情報であればRFC 3339で定義されている<code>2021-11-10T04:20:00Z</code>ないし<code>2021-11-10T13:20:00+09:00</code>のようなフォーマットで返すべきです。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>[
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;title&#34;</span>: <span style=color:#e6db74>&#34;todo title#1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;completed&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;createdAt&#34;</span>: <span style=color:#e6db74>&#34;2021-11-10T04:20:00Z&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><h4 id=多くの情報を一度に返す>多くの情報を一度に返す
<a class=anchor href=#%e5%a4%9a%e3%81%8f%e3%81%ae%e6%83%85%e5%a0%b1%e3%82%92%e4%b8%80%e5%ba%a6%e3%81%ab%e8%bf%94%e3%81%99>#</a></h4><p>また、多くの情報を一度に返すとはどういうことかというと、画面に表示するかどうかに関わらずリソースに関わる情報を返すということです。
前述したように画面を描画するにあたって多くのAPIリクエストを必要とする<strong>おしゃべりなAPI</strong>は良くないAPIです。</p><p>HTTPのオーバーヘッドはとにかく大きいため、パフォーマンス向上のためにはいかにHTTP通信の回数を減らす方が大事になってきます。
画面を見るのは人間ですが、<strong>JSONを処理するのは人間ではなくプログラム</strong>です。
画面を描画するにあたって必要がなければ、プログラムで使わなければいいだけです。
プログラム相手に遠慮する必要はありません。多くの情報を一度に返しましょう。</p><h3 id=swaggeroas30>Swagger(OAS3.0)
<a class=anchor href=#swaggeroas30>#</a></h3><p>APIの仕様記述の標準仕様に <a href=https://swagger.io/>Swagger</a> があります。
SwaggerはAPI仕様定義のデファクトスタンダードで、JSONないしYAMLでAPIの仕様を記述することができます。
Swaggerの仕様については以下のリンクを参照してください。</p><p><a href=https://swagger.io/specification/>https://swagger.io/specification/</a></p><p>APIの設計をするにあたって、<a href=https://github.com/swagger-api/swagger-editor>Swagger Editor</a> を活用すると良いでしょう。
Dockerをインストールした上で、以下のコマンドを起動するとSwagger Editorを起動することができます。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker pull swaggerapi/swagger-editor
</span></span><span style=display:flex><span>docker run -d -p 80:8080 swaggerapi/swagger-editor
</span></span></code></pre></div><p><img src=swaggerEditor.jpg alt=SwaggerEditor></p><p>バックエンドの開発にあたっては、<strong>Swagger Editorをつかって仕様を最初に設計を行い。チーム内でレビューないし合意をとってから開発するプロセスを強く推奨します。</strong>
例として、今回のTodoアプリケーションのバックエンドAPI構成例を以下に記載します。</p><p><a href=openapi.yaml>openapi.yaml</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-YAML data-lang=YAML><span style=display:flex><span><span style=color:#f92672>openapi</span>: <span style=color:#ae81ff>3.0.1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>info</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>title</span>: <span style=color:#ae81ff>Todo App</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>description</span>: <span style=color:#ae81ff>This is the backend API definition for the task management application.</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>termsOfService</span>: <span style=color:#ae81ff>https://onebase-fujitsu.github.io/agile-dev-guide/</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>license</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Creative Commons BY-NC-SA 4.0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>url</span>: <span style=color:#ae81ff>https://creativecommons.org/licenses/by-nc-sa/4.0/</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>version</span>: <span style=color:#ae81ff>1.0.0</span>
</span></span><span style=display:flex><span><span style=color:#f92672>servers</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>url</span>: <span style=color:#ae81ff>https://localhost:8080</span>
</span></span><span style=display:flex><span><span style=color:#f92672>tags</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>todos</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>description</span>: <span style=color:#ae81ff>API for managing todo</span>
</span></span><span style=display:flex><span><span style=color:#f92672>paths</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>/todos</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>get</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>tags</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>todos</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>summary</span>: <span style=color:#ae81ff>Get all todo list</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>operationId</span>: <span style=color:#ae81ff>getTodos</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>responses</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>200</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>description</span>: <span style=color:#ae81ff>OK</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>content</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>application/json</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>schema</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>type</span>: <span style=color:#ae81ff>array</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>items</span>:
</span></span><span style=display:flex><span>                  <span style=color:#f92672>$ref</span>: <span style=color:#e6db74>&#39;#/components/schemas/Todo&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>example</span>:
</span></span><span style=display:flex><span>                [
</span></span><span style=display:flex><span>                  {
</span></span><span style=display:flex><span>                    <span style=color:#f92672>id</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>title</span>: <span style=color:#e6db74>&#34;Tado Title#1&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>completed</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>                  }
</span></span><span style=display:flex><span>                ]
</span></span><span style=display:flex><span>    <span style=color:#f92672>post</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>tags</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>todos</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>summary</span>: <span style=color:#ae81ff>Add a new todo</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>operationId</span>: <span style=color:#ae81ff>addTodos</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>requestBody</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>description</span>: <span style=color:#ae81ff>Pet object that needs to be added to the store</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>content</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>application/json</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>schema</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>type</span>: <span style=color:#ae81ff>object</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>properties</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>title</span>:
</span></span><span style=display:flex><span>                  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>string</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>example</span>:
</span></span><span style=display:flex><span>              {
</span></span><span style=display:flex><span>                <span style=color:#f92672>title</span>: <span style=color:#e6db74>&#34;Todo Title&#34;</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>        <span style=color:#f92672>required</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>responses</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>201</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>description</span>: <span style=color:#ae81ff>Created</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>content</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>application/json</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>schema</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>$ref</span>: <span style=color:#e6db74>&#39;#/components/schemas/Todo&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>example</span>:
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                  <span style=color:#f92672>id</span>: <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                  <span style=color:#f92672>title</span>: <span style=color:#e6db74>&#34;Tado Title#1&#34;</span>,
</span></span><span style=display:flex><span>                  <span style=color:#f92672>completed</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>        <span style=color:#f92672>400</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>description</span>: <span style=color:#ae81ff>Bad Request</span>
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>/todos/{id}:</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>patch</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>tags</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>todos</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>summary</span>: <span style=color:#ae81ff>patch todo</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>parameters</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>id</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>in</span>: <span style=color:#ae81ff>path</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>schema</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>type</span>: <span style=color:#ae81ff>integer</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>format</span>: <span style=color:#ae81ff>int32</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>required</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>requestBody</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>content</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>application/json</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>schema</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>type</span>: <span style=color:#ae81ff>object</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>properties</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>title</span>:
</span></span><span style=display:flex><span>                  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>string</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>completed</span>:
</span></span><span style=display:flex><span>                  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>boolean</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>example</span>:
</span></span><span style=display:flex><span>              {
</span></span><span style=display:flex><span>                <span style=color:#f92672>completed</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>      <span style=color:#f92672>responses</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>204</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>description</span>: <span style=color:#ae81ff>Resource Updated</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>400</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>description</span>: <span style=color:#ae81ff>Bad Request</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>404</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>description</span>: <span style=color:#ae81ff>Resource Not Found</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>delete</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>tags</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>todos</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>summary</span>: <span style=color:#ae81ff>delete todo</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>parameters</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>id</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>in</span>: <span style=color:#ae81ff>path</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>schema</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>type</span>: <span style=color:#ae81ff>integer</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>format</span>: <span style=color:#ae81ff>int32</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>required</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>responses</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>204</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>description</span>: <span style=color:#ae81ff>Resource Deleted</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>400</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>description</span>: <span style=color:#ae81ff>Bad Request</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>404</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>description</span>: <span style=color:#ae81ff>Resource Not Found</span>
</span></span><span style=display:flex><span><span style=color:#f92672>components</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>schemas</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>Todo</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>object</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>properties</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>id</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>type</span>: <span style=color:#ae81ff>integer</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>format</span>: <span style=color:#ae81ff>int64</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>title</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>type</span>: <span style=color:#ae81ff>string</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>completed</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>type</span>: <span style=color:#ae81ff>boolean</span>
</span></span></code></pre></div><p>APIの設計とSwaggerの仕様をきちんと理解することは非常に大事で、APIを外部に公開する際はこのSwaggerのyamlを公開することになります。
変な仕様書を公開するとかえって外部の開発者の混乱を招くことになります。Swagger(OAS3.0)以外の形式でAPI仕様を公開すべきではありません。
<a href=https://swagger.io/tools/swagger-ui/>Swagger UI</a> のようにSwaggerの仕様を見やすく、そして使いやすく公開するためのツールもあります。</p><p><strong>APIの設計は標準仕様をよく目を通し、仕様に則ったものを作りましょう。</strong>
設計したAPI仕様を読み、そしてAPIを使うのは一般のエンドユーザではなく開発者です。
開発者自身が使いやすくないAPIを作ってしまうと、とても外部の開発者に使ってもらうことは叶いません。
まずは、<strong>開発者自身が使いやすいAPIを目指しましょう。</strong></p><hr><p>6日目に続きます</p><a href=/agile-dev-guide/docs/practice/day6/ class=book-btn>6日目</a></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#タスク作成バックエンドapi>タスク作成バックエンドAPI</a><ul><li><a href=#テスト>テスト</a></li><li><a href=#実装>実装</a></li><li><a href=#再実行可能なテスト>再実行可能なテスト</a></li></ul></li><li><a href=#タスク画面のデザインの適用>タスク画面のデザインの適用</a></li><li><a href=#api設計>API設計</a><ul><li><a href=#いいapiの設計とは>いいAPIの設計とは</a></li><li><a href=#リソース志向設計>リソース志向設計</a></li><li><a href=#パラメータ>パラメータ</a></li><li><a href=#レスポンス設計>レスポンス設計</a></li><li><a href=#クライアントに忖度しない>クライアントに忖度しない</a></li><li><a href=#swaggeroas30>Swagger(OAS3.0)</a></li></ul></li></ul></nav></div></aside></main></body></html>